---
platform: linux

image_resource:
  type: registry-image
  source: { repository: node, tag: "12" }

inputs:
  - name: protect-js-sdk

run:
  path: /bin/sh
  args:
    - -c
    - |
      echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" > ~/.npmrc
      cd protect-js-sdk
      if ! yarn install
      then
        echo "ERROR: yarn install failed" 
        exit 1
      fi
      if ! yarn lint
      then
        echo "ERROR: yarn lint failed" 
        exit 1
      fi
      if ! yarn test
      then
        echo "ERROR: yarn test failed" 
        exit 1
      fi
